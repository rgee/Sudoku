<!DOCTYPE html>  <html> <head>   <title>sudoku.solver.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="sudoku.board.html">                 sudoku.board.js               </a>                                           <a class="source" href="sudoku.core.html">                 sudoku.core.js               </a>                                           <a class="source" href="sudoku.solver.html">                 sudoku.solver.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               sudoku.solver.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
	<span class="kd">function</span> <span class="nx">Solver</span><span class="p">(</span><span class="nx">board</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Array of 2d, row-major arrays representing the 3x3 subSquares on the board.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Board object</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">this</span><span class="p">.</span><span class="nx">board</span> <span class="o">=</span> <span class="nx">board</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>3d Array repreenting the internal representation of the board, which is an array of potential values an unfilled square could
take for each unfilled square.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Cached copy of the internal representation from the previous iteration.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">this</span><span class="p">.</span><span class="nx">lastInternalRepr</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Set up the internal representation.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">this</span><span class="p">.</span><span class="nx">processSubSquares</span><span class="p">();</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">calculatePotentials</span><span class="p">();</span>
	<span class="p">}</span>


	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">compareArrays</span><span class="p">)</span> <span class="p">{</span>
		<span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">compareArrays</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
		    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">compareArrays</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//likely nested array</span>
		            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">compareArrays</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		            <span class="k">else</span> <span class="k">continue</span><span class="p">;</span>
		        <span class="p">}</span>
		        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
		    <span class="p">}</span>
		    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
		<span class="p">};</span>
	<span class="p">}</span>

	<span class="nx">Solver</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Run through all knowledge-refinement and square-filling tactics once.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">solve</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">processSubSquares</span><span class="p">();</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">eliminatePairs</span><span class="p">();</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">eliminateTriples</span><span class="p">();</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">takeOpportunities</span><span class="p">();</span>
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Divides the grid into the 3x3 units for constraint testing and stores them in
a linear array in row-major order. Each element of subSquares itself is a 2d
array representing the subSquare in row-major order.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">processSubSquares</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span> <span class="o">=</span> <span class="p">[];</span>
			<span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">col</span><span class="o">+=</span><span class="mi">3</span><span class="p">){</span>
				<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">row</span><span class="o">+=</span><span class="mi">3</span><span class="p">){</span>
					<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
					<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="nx">x</span><span class="p">){</span>
						<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="nx">y</span><span class="p">){</span>
							<span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">board</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">col</span> <span class="o">+</span> <span class="nx">x</span><span class="p">][</span><span class="nx">row</span> <span class="o">+</span> <span class="nx">y</span><span class="p">]);</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
				<span class="p">}</span>
				
			<span class="p">}</span>
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Analyze both the internal state and previous state and generate a summary of changes
in the form of an array of strings, each representing a single change.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">summarizeChanges</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Fill in a square on the grid and update internal representations </p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">fillSquare</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">,</span> <span class="nx">val</span><span class="p">){</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">board</span><span class="p">.</span><span class="nx">fillSquare</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">processSubSquares</span><span class="p">();</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">calculatePotentials</span><span class="p">();</span>
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Fill a square on the grid if it only has one potential value.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">takeOpportunities</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="kd">var</span> <span class="nx">col</span> <span class="o">=</span> <span class="nx">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

			<span class="k">for</span><span class="p">(</span><span class="nx">col</span><span class="p">;</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">col</span><span class="o">++</span><span class="p">){</span>
				<span class="k">for</span><span class="p">(</span><span class="nx">row</span><span class="p">;</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">row</span><span class="o">++</span><span class="p">){</span>
					<span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">].</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">fillSquare</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span><span class="nx">col</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>
					<span class="p">}</span>	
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Helper function to do row-major math on the subSquare grid </p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">subSquareIdx</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span><span class="nx">col</span><span class="p">){</span>
			<span class="k">return</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">row</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">col</span><span class="o">/</span><span class="mi">3</span><span class="p">));</span>
		<span class="p">},</span>
		<span class="nx">inverseSubSquareIdx</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ssIdx</span><span class="p">){</span>
			<span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">ssIdx</span> <span class="o">%</span> <span class="mi">9</span><span class="p">,</span>
				<span class="nx">col</span> <span class="o">=</span> <span class="nx">ssIdx</span> <span class="o">-</span> <span class="p">(</span><span class="nx">row</span> <span class="o">*</span> <span class="mi">9</span><span class="p">);</span>
			<span class="k">return</span> <span class="p">[</span><span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">];</span>	
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Calculate the potential numbers for each grid square, thus creating the solver's internal
representation of the sudoku board. Creates a 3d array of potential numbers from 1-9. </p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">calculatePotentials</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="kd">var</span> <span class="nx">all</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">];</span>

			<span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">row</span><span class="o">++</span><span class="p">){</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
				<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">col</span><span class="o">++</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Calculate possible numbers based on row/col/subsquare constraints if not given.</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">board</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]){</span>
						 <span class="kd">var</span> <span class="nx">subSquareIdx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">subSquareIdx</span><span class="p">(</span><span class="nx">row</span><span class="p">,</span><span class="nx">col</span><span class="p">);</span>
						 <span class="kd">var</span> <span class="nx">possibilities</span> <span class="o">=</span> <span class="nx">all</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
						 <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">all</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
						 	<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
					 		<span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">board</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">row</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">all</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
					 			<span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
					 		<span class="p">}</span>
					 		<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span>
					 			<span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">board</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="o">===</span> <span class="nx">all</span><span class="p">[</span><span class="nx">i</span><span class="p">]){</span>
					 				<span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
					 				<span class="k">break</span><span class="p">;</span>
					 			<span class="p">}</span>
					 		<span class="p">}</span>

					 		<span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span><span class="p">[</span><span class="nx">subSquareIdx</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">all</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">){</span>
					 			<span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
					 		<span class="p">}</span>
					 		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">){</span>
					 			<span class="nx">possibilities</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">possibilities</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">all</span><span class="p">[</span><span class="nx">i</span><span class="p">]),</span><span class="mi">1</span><span class="p">);</span>
					 		<span class="p">}</span>
						 <span class="p">}</span>
						 <span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="o">=</span> <span class="nx">possibilities</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>If a number is only a candidate in one row or column of a 3x3 subsquare, we can remove it as a candidate
from all cells in that particular row or column. It must appear in that particular subsquare or else
that subsquare would have no other way of filling the number.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">onlyCandidate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
		
		<span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Taking each group of three columns or rows (non-overlapping), if a number appears in two of the three subsquares
the group covers, then we know what row or column that number must appear within the final subsquare that does
not have it. Using that, we see if the row or column, within the subgroup without that number only has one square
left unfilled. If so, fill it with that number because we know it could go nowhere else.</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">allButOne</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="kd">var</span> <span class="nx">all</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">];</span>
			<span class="nx">all</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Check rows of subSquares</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">startIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">endIdx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">endIdx</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">startIdx</span> <span class="o">+=</span><span class="mi">3</span><span class="p">,</span> <span class="nx">endIdx</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>The current group of subsquares we're comparing</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="kd">var</span> <span class="nx">workingSet</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">startIdx</span><span class="p">,</span> <span class="nx">endIdx</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Map the subSquares to the positions of the given number, -1 if not there.</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">occupancy</span> <span class="o">=</span> <span class="nx">workingSet</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">){</span>
						<span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
						<span class="k">return</span> <span class="nx">idx</span><span class="p">;</span>
					<span class="p">}),</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Count how many subSquares have the given number already placed.</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">howMany</span> <span class="o">=</span> <span class="nx">occupancy</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">prev</span><span class="p">,</span> <span class="nx">curr</span><span class="p">){</span>
						<span class="k">return</span> <span class="nx">prev</span> <span class="o">+</span> <span class="p">(</span><span class="nx">curr</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>If we can determine the given number can only fit in one of the three rows.</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">if</span><span class="p">(</span><span class="nx">howMany</span> <span class="o">===</span> <span class="mi">2</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>The subSquare missing the current number.</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="kd">var</span> <span class="nx">subSquareToFill</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span><span class="p">[</span><span class="nx">occupancy</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)];</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>If there's only one empty square in this subSquare.</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span><span class="p">(</span><span class="nx">subSquareToFill</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">){</span>
								<span class="k">return</span> <span class="nx">elem</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
							<span class="p">}).</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">){</span>
							<span class="kd">var</span>	<span class="nx">rows</span> <span class="o">=</span> <span class="nx">occupancy</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">){</span>
									<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">inverseSubSquareIdx</span><span class="p">(</span><span class="nx">elem</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
								<span class="p">},</span><span class="k">this</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Deduce which row doesn't have the number placed.</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="nx">placementRow</span> <span class="o">=</span> <span class="p">[</span><span class="nx">startIdx</span><span class="p">,</span> <span class="nx">startIdx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">startIdx</span> <span class="o">+</span><span class="mi">2</span><span class="p">].</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">){</span>
									<span class="k">return</span> <span class="p">(</span><span class="nx">rows</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
								<span class="p">}),</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Deduce which column is the empty one in the target subSquare.</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="nx">placementCol</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inverseSubSquareIdx</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">subSquares</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">subSquareToFill</span><span class="p">)</span> <span class="o">+</span> <span class="nx">subSquareToFill</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="mi">0</span><span class="p">))[</span><span class="mi">1</span><span class="p">];</span>
							<span class="k">this</span><span class="p">.</span><span class="nx">fillSquare</span><span class="p">(</span><span class="nx">placementRow</span><span class="p">,</span> <span class="nx">placementCol</span><span class="p">,</span><span class="nx">val</span><span class="p">)</span>
						<span class="p">}</span>
							 
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">},</span> <span class="k">this</span><span class="p">);</span>
		<span class="p">},</span>
		<span class="nx">eliminatePairs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">eliminateGroups</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>	
		<span class="p">},</span>
		<span class="nx">eliminateTriples</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">eliminateGroups</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>	
		<span class="p">},</span>
		<span class="nx">eliminateGroups</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">){</span>

			<span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">removed</span> <span class="o">=</span> <span class="nx">numMatches</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
			<span class="nx">numMatches</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">row</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">row</span><span class="o">++</span><span class="p">){</span>
				<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">col</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">col</span><span class="o">++</span><span class="p">){</span>
					<span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">][</span><span class="nx">col</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">length</span><span class="p">){</span>
						<span class="cm">/* ****ROW CONSTRAINTS**** */</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Make a copy of the array to mutate.</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="nx">temp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Check if it's identical to any other pairs in the row after removing it from the array.</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="nx">removed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
						<span class="nx">temp</span> <span class="o">=</span> <span class="nx">temp</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">array</span><span class="p">){</span>
							<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">compareArrays</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">removed</span><span class="p">){</span>
								<span class="nx">removed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
								<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								
								<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">});</span>
						</pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Does enough of these exist in the row?</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="nx">other</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
						<span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">temp</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">val</span><span class="p">){</span>
							<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">compareArrays</span><span class="p">(</span><span class="nx">val</span><span class="p">)){</span>
								<span class="nx">numMatches</span><span class="o">++</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">});</span>
						<span class="k">if</span><span class="p">(</span><span class="nx">numMatches</span> <span class="o">===</span> <span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
							<span class="nx">numMatches</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Remove every instance of the pair from all its supersets in the row.</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">row</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">){</span>
								<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">compareArrays</span><span class="p">(</span><span class="nx">element</span><span class="p">)){</span>
									<span class="k">return</span> <span class="p">[</span><span class="nx">element</span><span class="p">];</span>
								<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
									<span class="kd">var</span> <span class="nx">t</span><span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">a</span><span class="p">){</span>
										<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
										<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
											<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">e</span><span class="p">){</span>
												<span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
												<span class="k">break</span><span class="p">;</span>
											<span class="p">}</span>
										<span class="p">}</span>
										<span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
									<span class="p">});</span>
									<span class="k">return</span> <span class="p">[</span><span class="nx">t</span><span class="p">];</span>
								<span class="p">}</span>
							<span class="p">});</span>
						<span class="p">}</span>

						<span class="cm">/* ****COLUMN CONSTRAINTS**** */</span>
						<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
							<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">compareArrays</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">col</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">!==</span> <span class="nx">row</span><span class="p">){</span>
								<span class="nx">numMatches</span><span class="o">++</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span>

						<span class="k">if</span><span class="p">(</span><span class="nx">numMatches</span> <span class="o">===</span> <span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span>
							<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
								<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">elem</span><span class="p">.</span><span class="nx">compareArrays</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">col</span><span class="p">])){</span>
									<span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">col</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">internalRepr</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">col</span><span class="p">].</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">arr</span><span class="p">){</span>
										<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
										<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
											<span class="k">if</span><span class="p">(</span><span class="nx">elem</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">e</span><span class="p">){</span>
												<span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
												<span class="k">break</span><span class="p">;</span>
											<span class="p">}</span>
										<span class="p">}</span>
										<span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
									<span class="p">});</span>
								<span class="p">}</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span> 
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">};</span>

    <span class="nx">Sudoku</span><span class="p">.</span><span class="nx">Solver</span> <span class="o">=</span> <span class="nx">Solver</span><span class="p">;</span>
<span class="p">})();</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 